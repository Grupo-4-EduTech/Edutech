<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/cssDashDiretor/cssDahsDiretor.css">
    <link rel="icon" sizes="56X56" href="../assets/a 1logo-Educare.svg">
    <link href='https://fonts.googleapis.com/css?family=Rubik' rel='stylesheet'>
    <title>Edu Tech | Dashboard</title>
</head>

<body class="bodyCadastro" onload="validarSessao(), professor()">
    <div class="menuLateral">
        <div class="logoEduTech"></div>
        <div class="navegacaoTitulo">
            <span>
                Navegação
            </span>
        </div>
        <div class="containerNavegacao">
            <div class="fileiraSelecionada" onclick="gotoDashDiretor()">
                <div class="imgFileira">
                    <img src="../assets/ph_chalkboard-teacher.svg" width="28px" height="28px">
                </div>
                <div class="tituloFileira">
                    Professores
                </div>
            </div>
            <div class="fileiraNavegacao" onclick="gotoTurmas()">
                <div class="imgFileira">
                    <img src="../assets/chapeuBranco.svg"  width="30px" height="30px">
                </div>

                <div class="tituloFileira">
                    Turmas
                </div>
            </div>
            <div class="fileiraNavegacao" onclick="gotoDashEscola()">
                <div class="imgFileira">
                    <img src="../assets/mdi_graph-box.svg" width="28px" height="28px">
                </div>
                <div class="tituloFileira">
                    Dashboard
                </div>
            </div>
            <div class="fileiraNavegacao">
                <div class="imgFileira">
                    <img src="../assets/descritores.svg" width="23px" height="23px">
                </div>
                <div class="tituloFileira">
                    Descritores
                </div>
            </div>
            <div class="fileiraNavegacao">
                <div class="imgFileira">
                    <img src="../assets/bx_support.svg" width="30px" height="30px">
                </div>
                <div class="tituloFileira">
                    Suporte
                </div>
            </div>
        </div>
        <div class="exit" onclick="SairDaDash()">
            <img src="../assets/sair.svg">
            <span>
                Sair
            </span>
        </div>
    </div>
    <div class="areaCadastro">
        <div class="modalSuporte" onclick="fecharmodal()">
            <div class="contentSuporte">
                <div class="titleSuporte">Meios de contato</div>
                <div class="EspacoModalSuporte"></div>
                <div class="titleSuporte">
                    <a href="https://wa.me/+5511914821813"  target="_blank">
                        <img src="../assets/Icon-whatsapp.png" class="iconsModal">
                    </a>
                    <a
                        href="https://www.instagram.com/theodorsouza42/?next=%2Fbluegodzi%2Ftagged%2F&locale=在
                        线定制塔吉克斯坦TEF证书联系%7B威信%2BTG%2F飞机%3A%40buth2788%7DsjwNH%3F%3F%3F%3F%3F%3Fѧ%3F%3FƾSwQuO"  target="_blank">
                        <img src="../assets/icon_insta.webp" class="iconsModal" id="Insta">
                    </a>
                    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=samukatsouza16@gmail.com&su=
    Necessito%20De%20apoio%20com%20a%20tela%20de%20Graficos(dashboard)!&body=Mensagem%20.%20.%20."  target="_blank">
                        <img src="../assets/icon_gmail.svg" class="iconsModal" id="google">
                    </a>
                </div>
            </div>
        </div>
        <div class="kpi">
            <div class="kpiProfessor">
                <div class="tituloProfessor">
                    <img src="../assets/ph_chalkboard-teacher.svg">
                    <span>
                        Professores
                    </span>
                </div>
                <div class="areaUsuario">
                    <img src="../assets/sino.svg" class="icone_notificacao" id="sino_alerts">
                    <span class="bolinha-notificacao" id="bolinha_vermelha"></span>
                    <img src="../assets/Line 96.svg">
                    <img src="../assets/user.svg" width="45px" height="45px">
                    <div class="nomeDiretor">
                        <span>
                            <span id=nomeUsuario>Magaiver Da Silva</span>
                            <br>
                            Diretor(a)
                        </span>
                    </div>
                </div>
            </div>
        </div>

         <!-- ALERTAS -->
    <div class="wrapper" id="wra">
        <div class="triangle"></div>
        <div class="base" id="basesinha">
        </div>
    </div>

        <div class="containerPerfil">
            <div class="nomeEmail">
                <div class="fotoProfessor">
                    <img src="../assets/mdi_account-student.svg" width="60px" height="60px">
                </div>
                <div class="emailProfessor">
                    <span style="font-size: 23px; font-weight: 550;" id="nomeProfessor">Wellington Rato</span>
                    <span id="emailProfessor">Email: wellington.rato@faria.neto.com</span>
                </div>
            </div>
            <div class="tituloInfo">
                Informações
            </div>
            <div class="infoProfessor">
                <div class="fileiraInfo">
                    &nbsp;<img src="../assets/telefone.svg" width="25px" height="25px"> &nbsp;&nbsp; <span id="telefoneProfessor">Telefone:
                        (11) 912345678</span>
                </div>
                <div class="fileiraInfo">
                    &nbsp;<img src="../assets/oi_book.svg" width="25px" height="25px"> &nbsp;&nbsp; <span id="materiaProfessor">Disciplina:
                        Matemática</span>
                </div>
                <div class="fileiraInfo">
                    <img src="../assets/chapeu.svg" width="30px" height="30px"> &nbsp; <span id="turmasProfessor">Turmas: 3ºA, 3ºB</span>
                </div>
            </div>
            <div class="editarExcluir">
                <span onclick="edit()">Editar&nbsp;</span>
                <span>|</span>
                <span onclick="excluirModal()">&nbsp;Excluir</span>
            </div>
        </div>
        <dialog close id="modalExcluir">
            <div id="textoModalExcluir">Tem certeza que deseja excluir esse professor?</div>
            <div style="display: flex; justify-content: end; gap: 10px; margin: 5px 5px;">
                <button id="cancelarExcluir" onclick="cancelarExcluir()">Cancelar</button>
                <button id="confirmarExcluir" onclick="confirmarExcluir()">Excluir</button>
            </div>
        </dialog>
</body>

<script src="../js/sessao.js"></script>

<script>
    function gotoDashDiretor() {
        window.location.href = "dashDiretor.html"
    }

    function gotoTurmas() {
        window.location.href = "turmas.html"
    }

    function gotoDashEscola() {
        window.location.href = "dashEscola.html"
    }

    function abrirModais(codigoModal) {
    let listamodais = ['.modalSuporte']
    const modal1 = document.querySelector(listamodais[codigoModal])
    modal1.style.display = 'block'
}
function abrirSuporte() { 
    let codigoModal = 0
    abrirModais(codigoModal);
}

function fecharmodal(codigoModal){
 let listamodais = ['.modalSuporte']
        for(let i = 0;i <=listamodais.length;i++) {  
            let modal1 = document.querySelector(listamodais[i])
            modal1.style.display = 'none'
}
}

function SairDaDash(){
    limparSessao();
    window.location.href = "../index.html"
}

function professor(){
    let params = new URLSearchParams(document.location.search);
    let idUsuario = params.get("idProfessor")

    fetch(`/diretor/infoProfessor/${idUsuario}`, {
        method: "GET",
    }).then(function (resposta) {
        resposta.json().then((professor) => {
            nomeProfessor.innerHTML = professor[0].nome;
            emailProfessor.innerHTML = `Email: ${professor[0].email}`;
            telefoneProfessor.innerHTML = `Telefone: ${professor[0].telefone}`;
            materiaProfessor.innerHTML = `Disciplina: ${professor[0].fkMateria==1?"Matemática":"Português"}`;
            turmasProfessor.innerHTML = `Turmas: ${professor[0].turmas}`;
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
    })
}


function edit(){
    let params = new URLSearchParams(document.location.search);
    let idUsuario = params.get("idProfessor");
    window.location.href = "editarProfessor.html?idProfessor="+idUsuario
}

function excluirModal() {
    modalExcluir.showModal();
}

function cancelarExcluir() {
    modalExcluir.close();
}

function confirmarExcluir() {
    modalExcluir.innerHTML = "<span>Insira sua senha para confirmar</span><br><input id='senhaConfirmar' type='password'><button onclick='excluir()'>Confirmar</button>"
}

function excluir(){
    let params = new URLSearchParams(document.location.search);
    let idUsuario = params.get("idProfessor");
    let senha = senhaConfirmar.value;

    fetch(`/diretor/confirmarOperacao/${sessionStorage.ID_USUARIO}/${senha}`, {
        method: "GET",
    }).then(function (resposta) {
        if (resposta.ok) {
            fetch(`/diretor/excluirProfessor/${idUsuario}`, {
                method: "DELETE",
            }).then(function (resposta) {
                if (resposta.ok) {
                    alert("Professor removido com sucesso!");
                    gotoDashDiretor();
                }
            });
        }else{
            alert("Falha em validar usuário.")
        }
    });
    
}

</script>

<script src="../js/alertaDiretor.js"></script>

