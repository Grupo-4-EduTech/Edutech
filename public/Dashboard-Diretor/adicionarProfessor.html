<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/cssDashDiretor/cssDahsDiretor.css">
    <link rel="icon" sizes="56X56" href="../assets/a 1logo-Educare.svg">
    <link href='https://fonts.googleapis.com/css?family=Rubik' rel='stylesheet'>
    <title>Edu Tech | Dashboard</title>
</head>
<body class="bodyCadastro" onload="validarSessao()">
    <div class="menuLateral">
        <div class="logoEduTech"></div>
        <div class="navegacaoTitulo">
            <span>
                Navegação
            </span>
        </div>
        <div class="containerNavegacao">
            <div class="fileiraSelecionada" onclick="gotoDashDiretor()">
                <div class="imgFileira">
                    <img src="../assets/ph_chalkboard-teacher.svg" width="28px" height="28px">
                </div>
                <div class="tituloFileira">
                    Professores
                </div>
            </div>
            <div class="fileiraNavegacao" onclick="gotoTurmas()">
                <div class="imgFileira">
                    <img src="../assets/chapeuBranco.svg"  width="30px" height="30px">
                </div>
                <div class="tituloFileira">
                    Turmas
                </div>
            </div>
            <div class="fileiraNavegacao" onclick="gotoDashEscola()">
                <div class="imgFileira">
                    <img src="../assets/mdi_graph-box.svg" width="28px" height="28px">
                </div>
                <div class="tituloFileira">
                    Dashboard
                </div>
            </div>
            <div class="fileiraNavegacao">
                <div class="imgFileira">
                    <img src="../assets/descritores.svg" width="23px" height="23px">
                </div>
                <div class="tituloFileira">
                    Descritores
                </div>
            </div>
            <div class="fileiraNavegacao">
                <div class="imgFileira">
                    <img src="../assets/bx_support.svg" width="30px" height="30px">
                </div>
                <div class="tituloFileira">
                    Suporte
                </div>
            </div>
        </div>
        <div class="exit" onclick="SairDaDash()">
            <img src="../assets/sair.svg">
            <span>
                Sair
            </span>
        </div>
    </div>
    <div class="areaCadastro">
        <div class="modalSuporte" onclick="fecharmodal()">
            <div class="contentSuporte">
                <div class="titleSuporte">Meios de contato</div>
                <div class="EspacoModalSuporte"></div>
                <div class="titleSuporte">
                    <a href="https://wa.me/+5511914821813"  target="_blank">
                        <img src="../assets/Icon-whatsapp.png" class="iconsModal">
                    </a>
                    <a
                        href="https://www.instagram.com/theodorsouza42/?next=%2Fbluegodzi%2Ftagged%2F&locale=在
                        线定制塔吉克斯坦TEF证书联系%7B威信%2BTG%2F飞机%3A%40buth2788%7DsjwNH%3F%3F%3F%3F%3F%3Fѧ%3F%3FƾSwQuO"  target="_blank">
                        <img src="../assets/icon_insta.webp" class="iconsModal" id="Insta">
                    </a>
                    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=samukatsouza16@gmail.com&su=
    Necessito%20De%20apoio%20com%20a%20tela%20de%20Graficos(dashboard)!&body=Mensagem%20.%20.%20."  target="_blank">
                        <img src="../assets/icon_gmail.svg" class="iconsModal" id="google">
                    </a>
                </div>
            </div>
        </div>
        <div class="kpi">
            <div class="kpiProfessor">
                <div class="tituloProfessor">
                    <img src="../assets/ph_chalkboard-teacher.svg">
                    <span>
                        Professores
                    </span>
                </div>
                <div class="areaUsuario">
                    <img src="../assets/sino.svg" class="icone_notificacao" id="sino_alerts">
                    <span class="bolinha-notificacao" id="bolinha_vermelha"></span>
                    <img src="../assets/Line 96.svg">
                    <img src="../assets/user.svg" width="45px" height="45px">
                    <div class="nomeDiretor">
                        <span>
                            <span id=nomeUsuario>Magaiver Da Silva</span>
                            <br>
                            Diretor(a)
                        </span>
                    </div>
                </div>
            </div>
        </div>

          <!-- ALERTAS -->
          <div class="wrapper" id="wra">
            <div class="triangle"></div>
            <div class="base" id="basesinha">
            </div>
        </div>

        <div class="containerCadastrarProfessor">
            <div class="tituloCadastrar" id="tituloCadastro">
                <span>
                    Cadastro de professor
                </span>
            </div>
            <div class="fileiraInput">
                <div class="divisaoInput">
                    <span id="titulo_nome">
                        Nome
                    </span>
                    <input class="inputCadastrarProfessor" placeholder="Nome" id="input_nome">
                </div>
                <div class="divisaoInput"> 
                    <span id="titulo_sobrenome">
                        Sobrenome
                    </span>
                    <input class="inputCadastrarProfessor" placeholder="Sobrenome" id="input_sobrenome">
                </div>
            </div>
            <div class="fileiraInput">
                <div class="divisaoInput">
                    <span id="titulo_email">
                        Email
                    </span>
                    <input class="inputCadastrarProfessor" placeholder="Email" id="input_email">
                </div>
                <div class="divisaoInput"> 
                    <span id="titulo_telefone">
                        Telefone
                    </span>
                    <input class="inputCadastrarProfessor" placeholder="(XX) XXXXX - XXXX" id="input_telefone" maxlength="11">
                </div>
            </div>
            <div class="fileiraInput">
                <div class="divisaoInput">
                    <span id="titulo_senha">
                        Senha
                    </span>
                    <input class="inputCadastrarProfessor" placeholder="*******" id="input_senha" type="password">
                </div>
                <div class="divisaoInput"> 
                    <span id="titulo_disciplina">
                        Disciplina
                    </span>
                    <select class="selectCadastrarProfessor" id="select_disciplina">
                        <option value="0">Selecione...</option>
                        <option value="1">Matemática</option>
                        <option value="2">Português</option>
                    </select>
                </div>
            </div>
            <div class="proximo">
                <button class="proximo" onclick="validacaoCadastro()">
                    Próximo
                </button>
            </div>
        </div>
    </div>
</body>
</html>

<script src="../js/sessao.js"></script>

<script>

    function gotoAtribuicao(id, fkMateria){
        window.location.href = `atribuirTurmas.html?id=${id}&materia=${fkMateria}`;    

    }

    function gotoDashDiretor(){
        window.location.href = "dashDiretor.html"
    }

    function gotoTurmas(){
        window.location.href = "turmas.html"
    }

    function gotoDashEscola(){
        window.location.href = "dashEscola.html"
    }

    function validacaoCadastro (){

        input_nome.classList.remove("inputErro");
        input_sobrenome.classList.remove("inputErro");
        input_email.classList.remove("inputErro");
        input_telefone.classList.remove("inputErro");
        input_senha.classList.remove("inputErro");
        select_disciplina.classList.remove("selectErro");

        titulo_nome.innerHTML = 'Nome';
        titulo_sobrenome.innerHTML = 'Sobrenome';
        titulo_email.innerHTML = 'Email';
        titulo_telefone.innerHTML = 'Telefone';
        titulo_senha.innerHTML = 'Senha';
        titulo_disciplina.innerHTML = 'Disciplina';

        let nome = input_nome.value
        let sobrenome = input_sobrenome.value
        let email = input_email.value
        let telefone = input_telefone.value
        let senha = input_senha.value
        let disciplina = select_disciplina.value
        
        let inputs = document.querySelector(".inputCadastrarProfessor")
        let selects = document.querySelector(".selectCadastrarProfessor")

        if (!nome || !sobrenome || !email || !telefone || !senha || disciplina == 0 || email.indexOf("@") == -1 || !/^\d+$/.test(telefone)) {
            tituloCadastro.innerHTML = `
            <span style="color: #a11919;">Preencha todos os campos antes de prosseguir</span>
            `
            if (!nome) {
                input_nome.classList.add("inputErro")
                titulo_nome.innerHTML = `
                <span style="color: #a11919;">Nome inválido</span>
                `
            }  
            
            if (!sobrenome) {
                input_sobrenome.classList.add("inputErro")
                titulo_sobrenome.innerHTML = `
                <span style="color: #a11919;">Sobrenome inválido</span>
                `
            } 
            
            if (!email || email.indexOf("@") == -1) {
                input_email.classList.add("inputErro")
                titulo_email.innerHTML = `
                    <span style="color: #a11919;">Email inválido</span>
                    `
            } 
            
            if (!telefone || !/^\d+$/.test(telefone)) {
                input_telefone.classList.add("inputErro")
                titulo_telefone.innerHTML = `
                <span style="color: #a11919;">Telefone inválido</span>
                `
            } 

            if (!senha) {
                input_senha.classList.add("inputErro")
                titulo_senha.innerHTML = `
                <span style="color: #a11919;">Senha inválida</span>
                `
            }

            if (disciplina == 0) {
                select_disciplina.classList.add("selectErro")
                titulo_disciplina.innerHTML = `
                <span style="color: #a11919;">Selecione uma disciplina</span>
                `
            }
        
        } else {
            cadastrar(nome, sobrenome, email, telefone, senha, disciplina)
        }
    }

    function cadastrar(nome, sobrenome, email, telefone, senha, disciplina){
        var nomeVar = nome+" "+sobrenome;
        var emailVar = email;
        var senhaVar = senha;
        var telefoneVar = telefone;
        var fkEscolaVar = sessionStorage.FK_ESCOLA;
        var fkMateriaVar = disciplina;

        fetch("/diretor/cadastrarProfessor", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                nomeServer: nomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar,
                telefoneServer: telefoneVar,
                fkEscolaServer: fkEscolaVar,
                fkMateriaServer: fkMateriaVar
            }),
        }).then(function (resposta) {
            if(resposta.ok){
                return resposta.json();
            }else{throw "Houve um erro ao tentar realizar o cadastro!"}
        }).then(function (dados) {
            gotoAtribuicao(dados.id, disciplina)
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
    }

    function abrirModais(codigoModal) {
    let listamodais = ['.modalSuporte']
    const modal1 = document.querySelector(listamodais[codigoModal])
    modal1.style.display = 'block'
}
function abrirSuporte() { 
    let codigoModal = 0
    abrirModais(codigoModal);
}

function fecharmodal(codigoModal){
 let listamodais = ['.modalSuporte']
        for(let i = 0;i <=listamodais.length;i++) {  
            let modal1 = document.querySelector(listamodais[i])
            modal1.style.display = 'none'
}
}

function SairDaDash(){
    limparSessao();
    window.location.href = "../index.html"
}


</script>

<script src="../js/alertaDiretor.js"></script>